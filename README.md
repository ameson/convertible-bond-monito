# 可转债联动监控系统

全市场可转债-正股联动监控与套利机会检测系统

## 功能特性

- 🎯 **全市场监控**：自动监控全市场可转债及其正股的价格联动
- 📊 **套利机会检测**：检测正股脉冲（涨幅≥1.5%）且转债滞后（涨幅<0.5%）的套利机会
- 💰 **明显提示**：发现套利机会时，使用醒目的格式显示详细信息
- ⚡ **多线程处理**：使用线程池并发处理，提高数据获取效率
- 🔄 **自动重试**：网络错误自动重试，提高系统稳定性
- ⏰ **交易时间监控**：自动识别交易时间（9:30-11:30, 13:00-15:00）
- 📝 **详细日志**：完整的日志记录，便于追踪和分析
- 📦 **批量管理**：支持批量添加可转债代码

## 安装说明

### 环境要求

- Python 3.7+
- akshare
- pandas
- requests

### 安装依赖

```bash
pip install akshare pandas requests
```

或使用 conda：

```bash
conda install pandas requests
pip install akshare
```

## 使用方法

### 1. 添加可转债

运行 `add.py` 添加要监控的可转债：

```bash
python add.py
```

支持两种添加方式：
- **单个添加**：输入单个转债代码
- **批量添加**：输入多个转债代码（逗号分隔）或使用预设列表

示例：
```
请选择添加方式：
1. 单个添加
2. 批量添加
q. 退出

请输入选项 (1/2/q): 2
转债代码列表: 110095,123241,123180
```

### 2. 启动监控

运行 `check.py` 启动监控系统：

```bash
python check.py
```

程序会自动：
- 加载 `1.json` 中的可转债数据
- 在交易时间内每30秒扫描一次市场
- 发现套利机会时显示明显提示
- 将日志记录到 `monitor.log`

## 配置参数

在 `2.py` 中可以调整以下参数：

```python
CONFIG = {
    'pulse_threshold': 0.015,    # 正股脉冲阈值（1.5%）
    'stop_profit': 0.008,         # 止盈阈值（0.8%）
    'stop_loss': -0.005,         # 止损阈值（-0.5%）
    'check_interval': 30,         # 检查间隔（秒）
    'max_workers': 10,            # 最大线程数
    'min_bond_change': 0.005,    # 转债最小涨幅（0.5%）
    'data_file': '1.json',        # 数据文件
    'log_file': 'monitor.log',    # 日志文件
    'retry_times': 3,            # 重试次数
    'retry_delay': 2,             # 重试延迟（秒）
}
```

## 套利机会提示

当发现符合套利条件的转债时，会显示：

```
====================================================================================================
🎯🎯🎯 发现套利机会！🎯🎯🎯
====================================================================================================
📊 【转债信息】
    转债代码: 123241
    转债名称: 欧通转债
    转债价格: 120.50 元
    转债涨幅: 0.50% (滞后)
    溢价率: 5.20%
    成交额: 50000 万元

📈 【正股信息】
    正股代码: 300870
    正股名称: 欧陆通
    正股涨幅: 2.50% (脉冲)

💰 【套利空间】
    正股脉冲幅度: 2.50%
    转债滞后幅度: 0.50%
    套利空间: 2.00%
====================================================================================================
```

## 文件结构

```
股债联动/
├── 1.py              # 单个转债监控程序（旧版）
├── 2.py              # 全市场监控程序（主程序）
├── add.py            # 批量添加转债程序
├── 1.json            # 转债数据文件
├── monitor.log       # 监控日志文件
└── README.md        # 说明文档
```

## 数据来源

本系统使用以下数据源：

- **akshare.bond_cov_comparison**：获取转债-正股对比数据
- **akshare.bond_zh_cov**：获取全市场转债信息

## 注意事项

1. **交易时间**：系统只在交易时间内监控（9:30-11:30, 13:00-15:00）
2. **网络稳定性**：请确保网络连接稳定，系统会自动重试失败的请求
3. **数据延迟**：数据可能有几秒到几分钟的延迟，请以实际交易为准
4. **风险提示**：本系统仅用于辅助决策，不构成投资建议，投资有风险，请谨慎操作

## 常见问题

### Q: 如何添加更多转债？

A: 运行 `python add.py`，选择批量添加模式，输入转债代码列表。

### Q: 为什么有些转债代码添加失败？

A: 可能是转债已退市或数据源未收录。建议使用 `bond_zh_cov` 接口验证转债代码。

### Q: 如何调整监控频率？

A: 修改 `check.py` 中的 `check_interval` 参数（单位：秒）。

### Q: 如何查看历史日志？

A: 查看 `monitor.log` 文件，包含所有监控记录和套利机会。

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 联系方式

如有问题或建议，请通过 GitHub Issues 联系。

---

**免责声明**：本系统仅供学习和研究使用，不构成任何投资建议。使用本系统进行交易的所有风险由使用者自行承担。
